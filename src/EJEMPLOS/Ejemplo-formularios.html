<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Práctica: Formularios y eventos en jQuery</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <style>
        body {font-family: Arial; margin: 40px;}
        form {width: 300px; margin: 0 auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px;}
        input {width: 100%; padding: 8px; margin: 8px 0;}
        .error {color: red; font-size: 14px;}
        .ok {color: green; font-size: 14px;}
        button {padding: 10px 20px; margin-top: 10px;}
    </style>
</head>
<body>

<h2>Formulario de Registro</h2>
<form id="registroForm">
    <label>Nombre:</label>
    <input type="text" id="nombre" placeholder="Tu nombre">
    <div id="errorNombre" class="error"></div>

    <label>Email:</label>
    <input type="email" id="email" placeholder="ejemplo@correo.com">
    <div id="errorEmail" class="error"></div>

    <label>Edad:</label>
    <input type="number" id="edad" min="1" max="120">
    <div id="errorEdad" class="error"></div>

    <label>Contraseña:</label>
    <input type="password" id="password" placeholder="Mínimo 6 caracteres">
    <div id="errorPassword" class="error"></div>

    <button type="submit">Registrarse</button>
</form>

<div id="mensajeFinal"></div>

<script>
    $(function(){

        // EVENTO focus y blur
        $('input').on('focus', function(){
            $(this).css('background-color', '#e6f7ff');
        });

        $('input').on('blur', function(){
            $(this).css('background-color', '');
        });

        // Validación en tiempo real con keyup
        $('#nombre').on('keyup', function(){
            const valor = $(this).val().trim();
            if(valor.length < 3){
                $('#errorNombre').text('El nombre debe tener al menos 3 caracteres');
            } else {
                $('#errorNombre').text('');
            }
        });

        $('#email').on('keyup', function(){
            const email = $(this).val().trim();
            const patron = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if(!patron.test(email)){
                $('#errorEmail').text('Introduce un email válido');
            } else {
                $('#errorEmail').text('');
            }
        });

        $('#edad').on('keyup', function(){
            const edad = parseInt($(this).val());
            if(isNaN(edad) || edad < 18){
                $('#errorEdad').text('Debes tener al menos 18 años');
            } else {
                $('#errorEdad').text('');
            }
        });

        $('#password').on('keyup', function(){
            const pass = $(this).val();
            if(pass.length < 6){
                $('#errorPassword').text('La contraseña debe tener mínimo 6 caracteres');
            } else {
                $('#errorPassword').text('');
            }
        });

        // Evento SUBMIT
        $('#registroForm').on('submit', function(e){
            e.preventDefault(); // evita enviar el formulario

            // comprobar que no hay errores
            const errores = $('.error').filter(function(){
                return $(this).text() !== '';
            }).length;

            if(errores > 0){
                $('#mensajeFinal').text('Corrige los errores antes de enviar.').removeClass('ok').addClass('error');
            } else {
                $('#mensajeFinal').text('Formulario enviado correctamente ✅').removeClass('error').addClass('ok');
                // limpiar formulario
                $('#registroForm')[0].reset();
            }
        });

    });
</script>

</body>
</html>
